on mbdive(mb)
	tell application "Microsoft Outlook"
		local res
		set res to {}
		repeat with mbd in (mail folders of mb)
			set end of res to {mb_name:name of mbd, mb_children:my mbdive(mbd)}
		end repeat
		return res
	end tell
end mbdive

tell application "Microsoft Outlook"
	local results, mbres
	set mbres to {}
	local aclist, arec, alist
	set alist to {}
	set aclist to my account_list({pop accounts}, noop_filter)
	local indx
	repeat with indx in aclist
		set arec to {acct_user_name:acct_user_name, acct_name:acct_name, acct_user_fullname:acct_user_fullname, acct_emails:acct_emails} of indx
		local mbloop, mrec, mlist
		set mlist to {}
		repeat with mbloop in (get acct_mailboxes of indx)
			set end of mlist to {mb_name:name of mbloop, mb_children:my mbdive(mbloop)}
		end repeat
		set arec to arec & {acct_mailboxes:mlist}
		set end of alist to arec
	end repeat
	set results to alist
	return results
end tell